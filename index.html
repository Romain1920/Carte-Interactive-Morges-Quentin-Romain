<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Carte interactive - Morges</title>

</head>
<body>
  <!-- Bandeau principal : titre et toggles Diagnostic/Projet -->
  <header>
    <div class="header-top">
      <h1>Groupe 3 - Vielle ville de Morges</h1>
      <div class="scenario-switch" role="group" aria-label="Affichage des sections">
        <button class="scenario-button active" data-section-toggle="diagnostic" aria-pressed="true">Diagnostic</button>
        <button class="scenario-button active" data-section-toggle="projet" aria-pressed="true">Projet</button>
      </div>
    </div>
  </header>
  <!-- Bloc carte + overlays (slider, légende, panneau latéral) -->
  <div class="map-wrapper">
    <div id="map" role="application" aria-label="Carte interactive centrée sur Morges"></div>
    <div class="coord-display" id="coord-display" aria-live="polite">
      Lat 46.50900 · Lng 6.49600
    </div>
    <div class="noise-legend" id="noise-legend" aria-hidden="true">
      <div class="legend-title" id="noise-legend-title"></div>
      <div class="legend-body" id="noise-legend-body"></div>
    </div>
    <div class="map-source" id="map-source" aria-live="polite"></div>
    <div class="layer-slider" id="heat-slider" aria-hidden="true">
      <div class="layer-slider__header">
        <span id="heat-slider-title">Comparer le scénario 2060</span>
        <span id="heat-slider-value">2060 + projet</span>
      </div>
      <input type="range" min="0" max="100" value="100" id="heat-slider-input" aria-label="Comparer deux scénarios" />
      <div class="layer-slider__labels">
        <span id="heat-slider-min-label">Scénario 2060</span>
        <span id="heat-slider-max-label">2060 + projet</span>
      </div>
    </div>
    <button
      type="button"
      id="mobile-panel-toggle"
      class="mobile-panel-toggle"
      aria-controls="layer-panel"
      aria-expanded="false"
      aria-label="Ouvrir le panneau de filtres"
    >
      <span class="mobile-panel-toggle__icon" aria-hidden="true"></span>
      <span>Filtres &amp; couches</span>
    </button>
    <div class="mobile-panel-overlay" id="mobile-panel-overlay" hidden></div>
    <!-- Panneau latéral avec toutes les couches activables -->
    <div class="layer-toggle" id="layer-panel" role="region" aria-label="Affichage des couches">
      <h2>Affichage</h2>
      <!-- Section avec les données communes aux deux scénarios -->
      <section class="panel-section">
        <h3>Données de base</h3>
        <label class="toggle-item">
          <span>
            <span class="legend-icon square"></span>
            Périmètre du projet
          </span>
          <input type="checkbox" data-layer="perimeter" />
        </label>
      </section>
      <!-- Section Diagnostic : couches + filtres environnementaux -->
      <section class="panel-section" data-section="diagnostic">
        <h3>Données du diagnostic</h3>
        <div class="panel-subtitle">1. Un centre-ville enclavé par les infrastructures de transport</div>
        <label class="toggle-item">
          <span>
            <span class="legend-icon line"></span>
            Axes routiers principaux
          </span>
          <input type="checkbox" data-layer="diagnostic-axes" />
        </label>
        <label class="toggle-item">
          <span>
            <span class="legend-icon parking"></span>
            Espaces dédiés au stationnement
          </span>
          <input type="checkbox" data-layer="diagnostic-parking" />
        </label>

        <div class="panel-subtitle">2. Des espaces libres mais inaccessibles</div>
        <label class="toggle-item">
          <span>
            <span class="legend-icon green"></span>
            Espaces privés d’intérêt
          </span>
          <input type="checkbox" data-layer="diagnostic-private" />
        </label>

        <div class="panel-subtitle">3. Une relation au lac restreinte</div>
        <label class="toggle-item">
          <span>
            <span class="legend-icon blue"></span>
            Éléments saillants de la relation inégale avec le lac
          </span>
          <input type="checkbox" data-layer="diagnostic-lake" />
        </label>

        <div class="panel-subtitle panel-subtitle-consequence">En conséquence</div>
        <div class="filter-panel" aria-label="Filtres disponibles pour le diagnostic">
          <div class="filter-panel-header">
            <div class="filter-panel-title">Filtres disponibles</div>
            <p>Sélectionne l’indicateur environnemental à afficher : un seul à la fois pour plus de clarté.</p>
          </div>
          <div class="filter-button-grid">
            <button type="button" class="filter-button" data-filter="diagnostic-noise" aria-pressed="false">
              <span class="filter-swatch" aria-hidden="true"></span>
              <span class="filter-label">
                <strong>Pollution sonore (jour)</strong>
              </span>
            </button>
            <button type="button" class="filter-button" data-filter="diagnostic-air" aria-pressed="false">
              <span class="filter-swatch" aria-hidden="true"></span>
              <span class="filter-label">
                <strong>Pollution de l’air (NO₂)</strong>
              </span>
            </button>
            <button type="button" class="filter-button" data-filter="diagnostic-heat" aria-pressed="false">
              <span class="filter-swatch" aria-hidden="true"></span>
              <span class="filter-label">
                <strong>Un centre-ville vulnérable à la chaleur</strong>
              </span>
            </button>
          </div>
        </div>
      </section>
      <!-- Section Projet : mêmes contrôles mais pour les interventions -->
      <section class="panel-section" data-section="projet">
        <h3>Données du projet</h3>
        <div class="panel-subtitle">1. Un centre-ville libéré des flux de transit</div>
        <label class="toggle-item">
          <span>
            <span class="legend-icon line"></span>
            Axes routiers principaux retravaillés
          </span>
          <input type="checkbox" data-layer="project-axes" />
        </label>
        <label class="toggle-item">
          <span>
            <span class="legend-icon parking project"></span>
            Espaces dédiés au stationnement conservés et optimisés en surface
          </span>
          <input type="checkbox" data-layer="project-parking" />
        </label>
        <div class="panel-action-row">
          <button type="button" class="panel-action-button" data-action="parking-demo">Voir la démonstration des reports de stationnements</button>
        </div>

        <div class="panel-subtitle">2. Des espaces libres mis en valeur</div>
        <label class="toggle-item">
          <span>
            <span class="legend-icon project-spaces"></span>
            Espaces requalifiés ou libérés au potentiel urbain
          </span>
          <input type="checkbox" data-layer="project-spaces" />
        </label>
        <div class="panel-action-row">
          <button type="button" class="panel-action-button" data-action="project-intentions">Afficher les intentions de projets sur les espaces libérés</button>
        </div>

        <div class="panel-subtitle">3. Une relation au lac réinventée</div>
        <label class="toggle-item">
          <span>
            <span class="legend-icon lake-open"></span>
            Littoral désormais ouvert aux usagers
          </span>
          <input type="checkbox" data-layer="project-lake-open" />
        </label>
        <label class="toggle-item">
          <span>
            <span class="legend-icon lake-renature"></span>
            Littoral renaturé
          </span>
          <input type="checkbox" data-layer="project-lake-renature" />
        </label>

        <div class="panel-subtitle">4. Éléments supplémentaires</div>
        <label class="toggle-item">
          <span>
            <span class="legend-icon density"></span>
            Zones de densification identifiées
          </span>
          <input type="checkbox" data-layer="project-density" />
        </label>
        <label class="toggle-item">
          <span>
            <span class="legend-icon roofs"></span>
            Toitures végétalisables
          </span>
          <input type="checkbox" data-layer="project-roofs" />
        </label>
        <div class="panel-action-row">
          <button type="button" class="panel-action-button" data-action="project-density">Afficher la proposition de densification</button>
        </div>

        <div class="panel-subtitle panel-subtitle-consequence">En conséquence</div>
        <div class="filter-panel" aria-label="Filtres disponibles pour le projet">
          <div class="filter-panel-header">
            <div class="filter-panel-title">Filtres disponibles</div>
            <p>Visualise l’effet du projet sur les nuisances ou les gains attendus.</p>
          </div>
          <div class="filter-button-grid">
            <button type="button" class="filter-button" data-filter="project-noise" aria-pressed="false">
              <span class="filter-swatch" aria-hidden="true"></span>
              <span class="filter-label">
                <strong>Pollution sonore (jour)</strong>
              </span>
            </button>
            <button type="button" class="filter-button" data-filter="project-air" aria-pressed="false">
              <span class="filter-swatch" aria-hidden="true"></span>
              <span class="filter-label">
                <strong>Pollution de l’air (NO₂)</strong>
              </span>
            </button>
            <button type="button" class="filter-button" data-filter="project-heat" aria-pressed="false">
              <span class="filter-swatch" aria-hidden="true"></span>
              <span class="filter-label">
                <strong>Un centre-ville plus résilient</strong>
              </span>
            </button>
            <button type="button" class="filter-button" data-filter="project-attractivity" aria-pressed="false">
              <span class="filter-swatch" aria-hidden="true"></span>
              <span class="filter-label">
                <strong>Un potentiel d’attractivité développé</strong>
              </span>
            </button>
          </div>
        </div>
      </section>
    </div>
  </div>

  <!-- Panneau latéral pour afficher les fiches projet -->
  <div class="details-panel" id="details-panel" aria-hidden="true">
    <div class="details-content" role="dialog" aria-modal="true" aria-label="Informations détaillées">
      <button class="details-close" id="details-close" aria-label="Fermer">&times;</button>
      <div id="details-body"></div>
    </div>
  </div>

  <!-- Lightbox plein écran pour zoomer une image ou montrer un PDF -->
  <div class="lightbox" id="media-lightbox" aria-hidden="true">
    <div class="lightbox-content" role="dialog" aria-modal="true" aria-label="Média en plein écran">
      <button class="lightbox-close" id="lightbox-close" aria-label="Fermer l'aperçu">&times;</button>
      <img id="lightbox-image" alt="" />
      <iframe id="lightbox-frame" title="Document"></iframe>
    </div>
  </div>

  <!-- Modale utilisée par la démonstration des reports de stationnement -->
  <div class="parking-demo" id="parking-demo" aria-hidden="true">
    <div class="parking-demo__content" role="dialog" aria-modal="true" aria-label="Démonstration des reports de stationnement">
      <button type="button" class="parking-demo__close" id="parking-demo-close" aria-label="Fermer la démonstration">&times;</button>
      <div class="parking-demo__header">
        <div>
          <h4>Démonstration des reports de stationnements</h4>
          <p>Comptage réalisé le samedi 29 mai 2021 à 11h30 (forte affluence, météo favorable).</p>
        </div>
      </div>
      <div id="parking-demo-tabs" class="parking-demo__tabs" role="tablist"></div>
      <div id="parking-demo-body" class="parking-demo__slides"></div>
      <div class="parking-demo__footer">
        <button type="button" id="parking-demo-action">Fermer</button>
      </div>
    </div>
  </div>

  <script type="module" src="/src/bootstrap.js"></script>
</body>
</html>
